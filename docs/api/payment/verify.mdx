---
title: 'Verify Payment'
description: 'POST /payment/verify-payment - Verify Razorpay payment signature'
api: 'POST https://api.superbox.com/v1/payment/verify-payment'
---

## Endpoint

```
POST /payment/verify-payment
```

## Authentication

<ParamField header="Authorization" type="string" required>
  Bearer token
</ParamField>

## Request Body

<ParamField body="order_id" type="string" required>
  Razorpay order ID
</ParamField>

<ParamField body="payment_id" type="string" required>
  Razorpay payment ID
</ParamField>

<ParamField body="signature" type="string" required>
  Razorpay payment signature
</ParamField>

## Example Request

<CodeGroup>
```bash cURL
curl -X POST https://api.superbox.com/v1/payment/verify-payment \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "order_id": "order_Kz6Y7qJd9rDEaX",
    "payment_id": "pay_Kz6ZNcccrEYkO4",
    "signature": "7f9a3b8c1d2e3f4a5b6c7d8e9f0a1b2c"
  }'
```

```javascript JavaScript
const response = await fetch('https://api.superbox.com/v1/payment/verify-payment', {
  method: 'POST',
  headers: {
    'Authorization': `Bearer ${token}`,
    'Content-Type': 'application/json',
  },
  body: JSON.stringify({
    order_id: razorpayResponse.razorpay_order_id,
    payment_id: razorpayResponse.razorpay_payment_id,
    signature: razorpayResponse.razorpay_signature,
  }),
});

const result = await response.json();
```

```python Python
import requests

response = requests.post(
    'https://api.superbox.com/v1/payment/verify-payment',
    headers={'Authorization': f'Bearer {token}'},
    json={
        'order_id': 'order_Kz6Y7qJd9rDEaX',
        'payment_id': 'pay_Kz6ZNcccrEYkO4',
        'signature': '7f9a3b8c1d2e3f4a5b6c7d8e9f0a1b2c',
    }
)

result = response.json()
```
</CodeGroup>

## Response

<ResponseField name="verified" type="boolean">
  Payment verification status
</ResponseField>

<ResponseField name="payment" type="object">
  Payment details
  
  <Expandable title="properties">
    <ResponseField name="id" type="string">
      Payment record ID
    </ResponseField>
    
    <ResponseField name="order_id" type="string">
      Razorpay order ID
    </ResponseField>
    
    <ResponseField name="payment_id" type="string">
      Razorpay payment ID
    </ResponseField>
    
    <ResponseField name="amount" type="number">
      Payment amount
    </ResponseField>
    
    <ResponseField name="currency" type="string">
      Currency code
    </ResponseField>
    
    <ResponseField name="status" type="string">
      Payment status: `success`, `failed`
    </ResponseField>
    
    <ResponseField name="created_at" type="string">
      Payment timestamp
    </ResponseField>
  </Expandable>
</ResponseField>

<ResponseField name="subscription" type="object">
  Updated subscription details
  
  <Expandable title="properties">
    <ResponseField name="plan" type="string">
      Subscription plan
    </ResponseField>
    
    <ResponseField name="status" type="string">
      Subscription status
    </ResponseField>
    
    <ResponseField name="starts_at" type="string">
      Subscription start date
    </ResponseField>
    
    <ResponseField name="expires_at" type="string">
      Subscription expiry date
    </ResponseField>
  </Expandable>
</ResponseField>

### Success Response (200)

```json
{
  "verified": true,
  "payment": {
    "id": "pmt_1234567890",
    "order_id": "order_Kz6Y7qJd9rDEaX",
    "payment_id": "pay_Kz6ZNcccrEYkO4",
    "amount": 49900,
    "currency": "INR",
    "status": "success",
    "created_at": "2024-01-15T10:30:00Z"
  },
  "subscription": {
    "plan": "pro",
    "status": "active",
    "starts_at": "2024-01-15T10:30:00Z",
    "expires_at": "2025-01-15T10:30:00Z"
  },
  "message": "Payment verified successfully"
}
```

## Verification Process

The backend verifies the payment using Razorpay's signature verification:

```go
func verifySignature(orderID, paymentID, signature, secret string) bool {
    message := orderID + "|" + paymentID
    mac := hmac.New(sha256.New, []byte(secret))
    mac.Write([]byte(message))
    expectedSignature := hex.EncodeToString(mac.Sum(nil))
    
    return hmac.Equal([]byte(signature), []byte(expectedSignature))
}
```

<Check>
  Signature verification ensures the payment callback is authentic and hasn't been tampered with.
</Check>

## Webhook Handling

SuperBox also handles Razorpay webhooks for additional security:

```
POST /payment/webhook
```

Webhook events:
- `payment.authorized` - Payment successful
- `payment.failed` - Payment failed
- `payment.captured` - Payment captured
- `refund.created` - Refund initiated

## Error Responses

<CodeGroup>
```json 400 - Invalid Signature
{
  "error": "Invalid signature",
  "message": "Payment signature verification failed",
  "verified": false
}
```

```json 404 - Order Not Found
{
  "error": "Order not found",
  "message": "No order found with the provided order_id"
}
```

```json 409 - Already Verified
{
  "error": "Payment already verified",
  "message": "This payment has already been processed"
}
```
</CodeGroup>

## Complete Payment Flow

<Steps>
  <Step title="Create Order">
    User initiates payment, backend creates Razorpay order
    
    ```
    POST /payment/create-order
    ```
  </Step>

  <Step title="Open Checkout">
    Frontend opens Razorpay checkout with order details
    
    ```javascript
    const razorpay = new Razorpay(options);
    razorpay.open();
    ```
  </Step>

  <Step title="User Pays">
    User completes payment in Razorpay checkout
  </Step>

  <Step title="Verify Signature">
    Frontend sends payment response to backend for verification
    
    ```
    POST /payment/verify-payment
    ```
  </Step>

  <Step title="Activate Subscription">
    Backend verifies signature and activates subscription
  </Step>

  <Step title="Webhook Confirmation">
    Razorpay sends webhook event for additional confirmation
    
    ```
    POST /payment/webhook
    ```
  </Step>
</Steps>

## Next Steps

<CardGroup cols={2}>
  <Card title="Payment Status" icon="clock" href="/api/payment/status">
    Check payment status
  </Card>
  <Card title="Create Order" icon="plus" href="/api/payment/create-order">
    Create new payment order
  </Card>
</CardGroup>
